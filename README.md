# è´¢åŠ¡è®°è´¦ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº FastAPI + SQLAlchemy æ„å»ºçš„ç®€æ˜“è´¢åŠ¡è®°è´¦ç³»ç»Ÿï¼Œæ”¯æŒä¼šè®¡å‡­è¯å½•å…¥ã€ç§‘ç›®ç®¡ç†ã€è´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆç­‰åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ“ **ä¼šè®¡å‡­è¯ç®¡ç†**ï¼šæ”¯æŒå€Ÿè´·å¹³è¡¡çš„å‡­è¯å½•å…¥å’Œç¼–è¾‘
- ğŸ“Š **ç§‘ç›®ç®¡ç†**ï¼šæ”¯æŒç§‘ç›®å±‚çº§ç»“æ„ï¼Œå¯è®¾ç½®ç§‘ç›®ç±»å‹ã€ç¼–ç ã€éšè—ç­‰å±æ€§
- ğŸ’¼ **ä¸šåŠ¡æµç¨‹**ï¼šæ”¯æŒé”€å”®ã€é‡‡è´­ã€è´¹ç”¨æŠ¥é”€ã€æ”¶ä»˜æ¬¾ç­‰ä¸šåŠ¡æµç¨‹å•æ®
- ğŸ“ˆ **è´¢åŠ¡æŠ¥è¡¨**ï¼š
  - èµ„äº§è´Ÿå€ºè¡¨
  - åˆ©æ¶¦è¡¨
  - ç°é‡‘æµé‡è¡¨
  - ç§‘ç›®ä½™é¢è¡¨
  - äº¤æ˜“æ˜ç»†è¡¨
- âš¡ **å®æ—¶æŠ¥è¡¨**ï¼šå¿«é€Ÿç”Ÿæˆå½“å‰æ—¥æœŸçš„æŠ¥è¡¨ï¼ˆä¸ä¿å­˜ï¼‰
- ğŸ’° **ç°é‡‘æµé‡åˆ†ç±»**ï¼šæ”¯æŒç»è¥æ´»åŠ¨ã€æŠ•èµ„æ´»åŠ¨ã€ç­¹èµ„æ´»åŠ¨çš„ç°é‡‘æµé‡åˆ†ç±»
- ğŸ“… **æœˆåº¦æŠ¥è¡¨ç¼“å­˜**ï¼šè‡ªåŠ¨ç”Ÿæˆå¹¶ç¼“å­˜ä¸Šä¸€æ•´æœˆçš„æŠ¥è¡¨å¿«ç…§

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**ï¼šFastAPI 0.110.0
- **ORM**ï¼šSQLAlchemy 2.0.23
- **æ•°æ®åº“**ï¼šMySQLï¼ˆé€šè¿‡ PyMySQLï¼‰
- **æ•°æ®éªŒè¯**ï¼šPydantic 2.6.4
- **æ¨¡æ¿å¼•æ“**ï¼šJinja2 3.1.4
- **WebæœåŠ¡å™¨**ï¼šUvicorn 0.30.1

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

- Python 3.8+ï¼ˆæ¨è 3.10+ï¼‰
- MySQL 5.7+ æˆ– 8.0+
- å·²åˆ›å»ºæ•°æ®åº“å’Œå¿…è¦çš„è¡¨ç»“æ„

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-username/accounting-system.git
cd accounting-system
```

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

**Windows:**
```bash
python -m venv .venv
.venv\Scripts\activate
```

**Linux/Mac:**
```bash
python -m venv .venv
source .venv/bin/activate
```

### 3. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 4. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` æ–‡ä»¶å¹¶é‡å‘½åä¸º `.env`ï¼š

**Windows:**
```bash
copy .env.example .env
```

**Linux/Mac:**
```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ï¼š

```env
DATABASE_URL=mysql+pymysql://ç”¨æˆ·å:å¯†ç @ä¸»æœº:ç«¯å£/æ•°æ®åº“å
```

ç¤ºä¾‹ï¼š
```env
DATABASE_URL=mysql+pymysql://root:password@127.0.0.1:3306/accounting_system
```

### 5. æ•°æ®åº“å‡†å¤‡

ç¡®ä¿ä½ çš„ MySQL æ•°æ®åº“ä¸­å·²åˆ›å»ºä»¥ä¸‹è¡¨ï¼š
- `accounts` - ä¼šè®¡ç§‘ç›®è¡¨
- `transactions` - äº¤æ˜“å‡­è¯è¡¨
- `splits` - åˆ†å½•è¡¨
- `business_documents` - ä¸šåŠ¡å•æ®è¡¨
- `business_document_items` - ä¸šåŠ¡å•æ®æ˜ç»†è¡¨
- `cashflow_types` - ç°é‡‘æµé‡åˆ†ç±»è¡¨
- `monthly_reports` - æœˆåº¦æŠ¥è¡¨ç¼“å­˜è¡¨ï¼ˆå¯é€‰ï¼‰

ä»¥åŠä»¥ä¸‹è§†å›¾ï¼š
- `v_account_balance` - ç§‘ç›®ä½™é¢è§†å›¾
- `v_transaction_detail` - äº¤æ˜“æ˜ç»†è§†å›¾

å¯ä»¥å‚è€ƒé¡¹ç›®ä¸­çš„ SQL æ–‡ä»¶åˆ›å»ºè¡¨ç»“æ„ã€‚

### 6. å¯åŠ¨æœåŠ¡

```bash
python run.py
```

æˆ–è€…ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆWindowsï¼‰ï¼š
```bash
start-app.bat
```

### 7. è®¿é—®åº”ç”¨

å¯åŠ¨æˆåŠŸåï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š

- **å‰ç«¯é¡µé¢**ï¼šhttp://127.0.0.1:8000/
- **API æ–‡æ¡£**ï¼šhttp://127.0.0.1:8000/docsï¼ˆå¦‚æœå¯ç”¨ï¼‰

## ğŸ“– ä¸»è¦åŠŸèƒ½è¯´æ˜

### ä¼šè®¡å‡­è¯

ç³»ç»Ÿæ”¯æŒæ ‡å‡†çš„å€Ÿè´·è®°è´¦æ³•ï¼Œæ¯æ¡å‡­è¯å¿…é¡»åŒ…å«è‡³å°‘ä¸¤æ¡åˆ†å½•ï¼Œä¸”å€Ÿè´·é‡‘é¢å¿…é¡»å¹³è¡¡ã€‚

**åˆ›å»ºå‡­è¯ç¤ºä¾‹ï¼š**
```json
{
  "post_date": "2025-01-15",
  "description": "è´­ç½®åŠå…¬ç”¨å“",
  "num": "JZ2025011501",
  "splits": [
    {"account_guid": "ASSET-GUID-001", "amount": 500.00, "memo": "ç°é‡‘æ”¯å‡º"},
    {"account_guid": "EXPENSE-GUID-002", "amount": -500.00, "memo": "åŠå…¬ç”¨å“è´¹ç”¨"}
  ]
}
```

> **æ³¨æ„**ï¼šé‡‘é¢ä»¥ "å€Ÿä¸ºæ­£ã€è´·ä¸ºè´Ÿ" çš„æ–¹å¼å½•å…¥ï¼Œç³»ç»Ÿä¼šåœ¨ä¿å­˜å‰æ ¡éªŒæ€»å’Œå¿…é¡»ä¸º 0ã€‚

### ä¸šåŠ¡æµç¨‹

ç³»ç»Ÿæ”¯æŒä»¥ä¸‹ä¸šåŠ¡æµç¨‹ï¼Œæ¯ä¸ªæµç¨‹ä¼šè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„ä¼šè®¡å‡­è¯ï¼š

- **é”€å”®ä¸šåŠ¡** (`POST /business/sales`)ï¼šé”€å”®å•†å“ç»™å®¢æˆ·
- **é‡‡è´­ä¸šåŠ¡** (`POST /business/purchases`)ï¼šä»ä¾›åº”å•†é‡‡è´­å•†å“
- **è´¹ç”¨æŠ¥é”€** (`POST /business/expenses`)ï¼šå‘˜å·¥æŠ¥é”€è´¹ç”¨
- **æ”¶ä»˜æ¬¾** (`POST /business/cashflow`)ï¼šè®°å½•æ”¶æ¬¾æˆ–ä»˜æ¬¾

### è´¢åŠ¡æŠ¥è¡¨

- **æœˆåº¦æŠ¥è¡¨** (`GET /reports/financial`)ï¼šæŸ¥çœ‹ä¸Šä¸€æ•´æœˆçš„æŠ¥è¡¨å¿«ç…§
- **å®æ—¶æŠ¥è¡¨** (`GET /reports/financial/current`)ï¼šå¿«é€Ÿç”Ÿæˆå½“å‰æ—¥æœŸçš„æŠ¥è¡¨ï¼ˆä¸ä¿å­˜ï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„

```
accounting-system/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py              # FastAPI åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database.py          # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ api/                 # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ accounts.py      # ç§‘ç›®ç›¸å…³æ¥å£
â”‚   â”‚   â”œâ”€â”€ transactions.py  # äº¤æ˜“ç›¸å…³æ¥å£
â”‚   â”‚   â”œâ”€â”€ pages.py         # é¡µé¢è·¯ç”±
â”‚   â”‚   â””â”€â”€ business.py      # ä¸šåŠ¡æµç¨‹æ¥å£
â”‚   â”œâ”€â”€ models/              # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ account.py
â”‚   â”‚   â”œâ”€â”€ transaction.py
â”‚   â”‚   â”œâ”€â”€ split.py
â”‚   â”‚   â”œâ”€â”€ business_document.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ schemas/             # Pydantic æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ account.py
â”‚   â”‚   â”œâ”€â”€ transaction.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ crud/                # æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ account.py
â”‚   â”‚   â”œâ”€â”€ transaction.py
â”‚   â”‚   â”œâ”€â”€ financial_report.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ templates/           # Jinja2 æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ base.html
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ accounts.html
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ static/              # é™æ€æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ js/
â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ guid_helper.py
â”‚       â””â”€â”€ amount_helper.py
â”œâ”€â”€ .env.example             # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore
â”œâ”€â”€ requirements.txt         # Python ä¾èµ–
â”œâ”€â”€ README.md
â””â”€â”€ run.py                   # å¯åŠ¨è„šæœ¬
```

## ğŸ”Œ API æ¥å£

### ç§‘ç›®ç®¡ç†

- `GET /accounts/` - æŸ¥è¯¢æ‰€æœ‰ç§‘ç›®
- `GET /accounts/{guid}` - æŸ¥çœ‹å•ä¸ªç§‘ç›®è¯¦æƒ…

### äº¤æ˜“ç®¡ç†

- `GET /transactions/` - æŸ¥è¯¢äº¤æ˜“åˆ—è¡¨
- `GET /transactions/{guid}` - æŸ¥çœ‹äº¤æ˜“è¯¦æƒ…
- `POST /transactions/` - åˆ›å»ºæ–°äº¤æ˜“
- `PUT /transactions/{guid}` - æ›´æ–°äº¤æ˜“
- `DELETE /transactions/{guid}` - åˆ é™¤äº¤æ˜“

### ä¸šåŠ¡æµç¨‹

- `POST /business/sales` - åˆ›å»ºé”€å”®å•
- `POST /business/purchases` - åˆ›å»ºé‡‡è´­å•
- `POST /business/expenses` - åˆ›å»ºè´¹ç”¨å•
- `POST /business/cashflow` - åˆ›å»ºæ”¶ä»˜æ¬¾å•

### æŠ¥è¡¨æŸ¥è¯¢

- `GET /reports/balances` - ç§‘ç›®ä½™é¢è¡¨
- `GET /reports/transaction-details` - äº¤æ˜“æ˜ç»†è¡¨
- `GET /reports/financial` - æœˆåº¦è´¢åŠ¡æŠ¥è¡¨
- `GET /reports/financial/current` - å½“å‰å®æ—¶æŠ¥è¡¨

## â“ å¸¸è§é—®é¢˜

### è¿æ¥æ•°æ®åº“å¤±è´¥

- æ£€æŸ¥ MySQL æœåŠ¡æ˜¯å¦å·²å¯åŠ¨
- ç¡®è®¤ `DATABASE_URL` é…ç½®æ˜¯å¦æ­£ç¡®
- éªŒè¯æ•°æ®åº“ç”¨æˆ·æ˜¯å¦æœ‰è¶³å¤Ÿçš„æƒé™

### é‡‘é¢ç²¾åº¦é—®é¢˜

ç³»ç»Ÿä½¿ç”¨ `value_num/value_denom` åˆ†æ•°å½¢å¼å­˜å‚¨é‡‘é¢ï¼Œç¡®ä¿ä¸ä¼šå¼•å…¥æµ®ç‚¹è¯¯å·®ã€‚æ˜¾ç¤ºæ—¶é»˜è®¤ä¿ç•™ 2 ä½å°æ•°ã€‚

### æŠ¥è¡¨æ•°æ®ä¸ºç©º

- ç¡®è®¤æ•°æ®åº“ä¸­å·²æœ‰äº¤æ˜“æ•°æ®
- æ£€æŸ¥ç§‘ç›®ç±»å‹åˆ†ç±»æ˜¯å¦æ­£ç¡®
- éªŒè¯æŠ¥è¡¨æ—¥æœŸèŒƒå›´æ˜¯å¦åˆç†

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚é˜… [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ“ æ›´æ–°æ—¥å¿—

### v0.1.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒåŸºæœ¬çš„ä¼šè®¡å‡­è¯ç®¡ç†
- æ”¯æŒç§‘ç›®ç®¡ç†å’Œå±‚çº§ç»“æ„
- æ”¯æŒä¸šåŠ¡æµç¨‹å•æ®
- æ”¯æŒè´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆ
- æ”¯æŒå®æ—¶æŠ¥è¡¨ç”Ÿæˆï¼ˆä¸ä¿å­˜ï¼‰

## ğŸ‘¤ ä½œè€…

ä½ çš„åå­—

---

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ Starï¼
